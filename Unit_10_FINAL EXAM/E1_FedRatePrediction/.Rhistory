fedFunds = read.csv("federalFundsRate.csv", stringsAsFactors = FALSE)
View(fedFunds)
nrow(fedFunds)
str(fedFunds)
summary(fedFunds)
table(fedFunds$RaisedFedFunds)
294/585
mean(fedFunds$RaisedFedFunds)
Chair <- as.factor(fedFunds$Chairman)
table(Chair)
sort(table(Chair))
sort(table(Chair), decreasing = TREU)
sort(table(Chair), decreasing = TRUe)
sort(table(Chair), decreasing = 1)
sort(table(Chair), decreasing = T)
fedFunds$Chairman = as.factor(fedFunds$Chairman)
fedFunds$DemocraticPres = as.factor(fedFunds$DemocraticPres)
fedFunds$fedFunds$RaisedFedFunds = as.factor(fedFunds$RaisedFedFunds)
summary(fedFunds)
fedFunds = read.csv("federalFundsRate.csv", stringsAsFactors = FALSE)
fedFunds$Chairman = as.factor(fedFunds$Chairman)
fedFunds$DemocraticPres = as.factor(fedFunds$DemocraticPres)
fedFunds$RaisedFedFunds = as.factor(fedFunds$RaisedFedFunds)
summary(fedFunds)
library(caTools)
set.seed(201)
splt = sample.split(fedFunds$RaisedFedFunds, SplitRatio = 0.7)
dfTrain = subset(fedFunds, splt == TRUE)
dfTest = subset(fedFunds, splt == FALSE)
glmModel1 <- glm(RaisedFedFunds ~ PreviousRate + Streak + Unemployment + HomeownershipRate + DemocraticPres + MonthsUntilElection, data = dfTrain, family = "binomial")
class(glmModel1)
mode(glmModel1)
summary(glmModel1)
write.csv(dfTest, "TestTemplate.csv", row.names = FALSE)
dfT1 <- read.csv("Test1.csv")
View(dfT1)
dfT1 <- dfT1[1, ]
predict(glmModel1, newdata = dfT1, type = "response")
summary(dfT1)
dfT1$Chairman = as.factor(dfT1$Chairman)
dfT1$RaisedFedFunds = as.factor(dfT1$RaisedFedFunds)
dfT1$DemocraticPres = as.factor(dfT1$DemocraticPres)
predict(glmModel1, newdata = dfT1, type = "response")
view(dfTrain)
View(dfTrain)
predict(glmModel1, newdata = dfT1, type = "prob")
predict(glmModel1, newdata = dfT1, type = "response")
summary(glmModel1)
summary(glmModel1)
summary(dfTrain$PreviousRate)
summary(dfTrain$Unemployment
)
summary(dfTrain$HomeownershipRate)
dfT2 <- read.csv("Test2.csv")
dfT2$RaisedFedFunds = as.factor(dfT2$RaisedFedFunds)
dfT2$Chairman = as.factor(dfT2$Chairman)
dfT2$DemocraticPres = as.factor(dfT2$DemocraticPres)
predict(glmModel1, newdata = dfT2, type = "response")
predglmModel1 <- predict.glm(glmModel1, newdata = dfTest, type = "response")
table(dfTest$RaisedFedFunds)
table(dfTest$RaisedFedFunds, predglmModel1 > 0.5)
library(ROCR)
predROC <- prediction(predglmModel1, dfTest$RaisedFedFunds)
predAUC <- performance(predROC, "auc")
as.numeric(predAUC@y.values)
predROC1 <- performance(predROC, "tpr", "fpr")
plot(predROC1, colorize = TRUE)
plot(predROC1, colorize = TRUE,print.cutoff.at = seq(0,1,0.1), text.adj = c(-0.2,1.7)))
plot(predROC1, colorize = TRUE,print.cutoff.at = seq(0,1,0.1), text.adj = c(-0.2,1.7))
plot(predROC1, colorize = TRUE,print.cutoff.at = seq(0,1,0.1))
plot(predROC1, colorize = TRUE, print.cutoffs.at = seq(0,1,0.1))
library(caret)
library(e1071)
numFolds = trainControl(method = "cv", number = 10)
cpGrid = expand.grid(.cp = seq(0.001, 0.050, 0.001))
train(RaisedFedFunds ~ PreviousRate + Streak + Unemployment + HomeownershipRate + DemocraticPres + MonthsUntilElection, data = dfTrain, method = "rpart", trControl = numFolds, tuneGrid = cpGrid)
set.seed(201)
numFolds = trainControl(method = "cv", number = 10)
cpGrid = expand.grid(.cp = seq(0.001, 0.050, 0.001))
cpGrid
train(RaisedFedFunds ~ PreviousRate + Streak + Unemployment + HomeownershipRate + DemocraticPres + MonthsUntilElection, data = dfTrain, method = "rpart", trControl = numFolds, tuneGrid = cpGrid)
cartModel1 <- rpart(RaisedFedFunds ~ PreviousRate + Streak + Unemployment + HomeownershipRate + DemocraticPres + MonthsUntilElection, data = dfTrain, method = "class", cp = 0.016)
prp(cartModel1)
library(rpart.plot)
prp(cartModel1)
prp(cartModel1)
predCART1 <- predict(cartModel1, newdata = dfTest, type = "class")
predCART1
table(dfTest$RaisedFedFunds, predCART1)
(64+48)/nrow(dfTest)

census <- read.csv("census.csv")
str(census)
summary(census)
library(rpart)
library(caTools)
library(rpart.plot)
library(randomForest)
set.seed(2000)
splt = sample.split(census$over50k, SplitRatio = 0.60)
Train = subset(census, splt == TRUE)
Test = subset(census, splt == FALSE)
Model1 = glm(over50 ~ ., data = Train, family = "binomial")
Model1 = glm(over50k ~ ., data = Train, family = "binomial")
summary(Model1)
predM1 <- predict(Model1, newdata = Test, type = "response")
table(Test$over50k, predM1 > 0.5)
(9051+1888)/nrow(Test)
table(Test$over50k)
9713/nrow(Test)
library(ROCR)
install.packages("ROCR")
library(ROCR)
ROCRPred1 <- prediction(predM1, Test$over50k)
aucTemp <- performance(ROCRPred1, "auc")
as.integer(aucTemp@y.values)
aucTemp@y.values
as.numeric(aucTemp@y.values)
as.numeric(aucTemp@x.values)
aucTemp@x.name
aucTemp@y.name
aucTemp@alpha.name
aucTemp
aucTemp
summary(census)
Model2 <- rpart(over50k ~ ., data = Train, method = "class")
prp(Model2)
summary(census)
predM2 <- predict(Model2, newdata = Test, type = "class")
table(Test$over50k, predM2
)
(9243+1596)/nrow(Test)
ROCRPred2 = prediction(predM2, Test$over50k)
predM2.1 <- predict(Model2, newdata = Test, type = "response")
predM2.1 <- predict(Model2, newdata = Test)
predM2.1
predM2.1[1]
predM2.1[ ,1]
predM2.1[ ,2]
ROCRPred2 = prediction(predM2.1[ ,2], Test$over50k)
aucTemp2 = performance(ROCCRPred2, "auc")
aucTemp2 = performance(ROCRPred2, "auc")
aucTemp2@y.values
plot(ROCRPred2)
set.seed(1)
TrainSmall = Train[sample(nrow(Train), 2000), ]
Model3 <- randomForest(over50k ~., data = TrainSmall)
set.seed(1)
Model3 <- randomForest(over50k ~., data = TrainSmall)
predM3 <- predict(Model3, newdata = Test, type = "response"
)
predM3
table(Test$over50k, predM3)
(9555+1204)/nrow(Test)
vu = varUsed(Modle3, count=TRUE)
vu = varUsed(Model3, count=TRUE)
usorted = sort(vu, decreasing = FALSE, index.return = TRUE)
dotchart(vusorted$x, names(Model3$forest$xlevels[vusorted$ix]))
vusorted = sort(vu, decreasing = FALSE, index.return = TRUE)
dotchart(vusorted$x, names(Model3$forest$xlevels[vusorted$ix]))
varImpPlot(Model3)
set.seed
set.seed(2)
library(caret)
library(e1071)
set.seed(2)
numFolds = trainControl(method="cv", number=10)
cartGrid = expand.grid(.cp = seq(0.002, 0.1, 0..02))
cartGrid = expand.grid(.cp = seq(0.002, 0.1, 0.02))
train(over50k ~ ., data = Train, method = "rpart", trControl = numtFolds, tuneGrid = cartGrid)
train(over50k ~ ., data = Train, method = "rpart", trControl = numFolds, tuneGrid = cartGrid)
Model4 = rpart(over50k ~ ., data = Train, method = "class", cp = 0.002)
predM4 <- predict(Model4, newdata = Test, type = "class")
table(Test$over50k, predM4)
(9178+1838)/nrow(Test)
prp(Model4)
list()
ls()
Model2
prp(Model4)
library(rpart)
library(rpart.plot)
prp(Model4)
q()
